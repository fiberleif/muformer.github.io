---
permalink: /
layout: single
classes: wide
toc: false
excerpt: "A Deep Learning Framework for Accurate Protein Fitness Landscape Modeling"
header:
    overlay_color: "#333"
    actions:
     - label: "arXiv"
       url: "https://arxiv.org/abs/2106.06800"
---
<style>
    h2 {
        font-size: large;
    };
    th {
        font-size: 0.8em;
        text-align: center;
        cursor: pointer;
    }
    td {
        font-size: 0.8em; 
        text-align: center;
    }
    i {
        cursor: pointer;
    }
    summary {
        display: inline;
        cursor: pointer;
    }
    summary::-webkit-details-marker {
        display: none;
    }
    details[open] summary * i[class="fas fa-angle-right"] {
        transform: rotate(90deg);
    }
</style>
<!-- <link rel="stylesheet" type="text/css" href="https://www.ebi.ac.uk/pdbe/pdb-component-library/css/pdbe-molstar-3.1.0.css"> -->
<link rel="stylesheet" type="text/css" href="https://www.ebi.ac.uk/pdbe/pdb-component-library/css/pdbe-molstar-light-3.1.0.css">
<script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="https://www.ebi.ac.uk/pdbe/pdb-component-library/js/pdbe-molstar-plugin-3.1.0.js"></script>
<script type="text/javascript" src="https://cdn.plot.ly/plotly-2.25.2.min.js" charset="utf-8"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script type="text/javascript" src="assets/js/dataprep.js"></script>

<div id="summary" style="padding-bottom:1em">
    <img src="assets/figures/model_overview.png" alt="overview" width="100%">
    <h1 id="header-summary" class="text-center">Abstract</h1>
    <p class="text-justify" style="font-size:large;width:80%;margin: 0 auto">Protein engineering is essential for a variety of applications, such as designing biologic drugs, optimizing enzymes, and developing novel functional molecules. Accurate protein fitness landscape modeling, such as predicting protein properties in sequence space, is critical for efficient protein engineering. Yet, due to the complexity of the landscape and high-dimensional sequence space, it remains as an unsolved problem. In this work, we present μFormer, a deep learning framework that combines a pre-trained protein language model with three scoring modules targeting protein features at multiple levels, to tackle this grand challenge. μFormer achieves state-of-the-art performance across diverse tasks, including predicting high-order mutants, modeling epistatic effects, handling insertion/deletion mutations, and generalizing to out-of-distribution scenarios. On the basis of prediction power, integrating μFormer with a reinforcement learning framework enables efficient exploration of the vast mutant space. We showcase that this integrated approach can design protein variants with up to 5-point mutations and potentially significant enhancement in activity for engineering tasks. The results highlight μFormer as a powerful and versatile tool for protein design, accelerating the development of innovative proteins tailored for specific applications.</p>
</div>
<div id="results" style="width:100%">
    <details open>
        <summary>
            <h1 id="header-results">Results  <i class="fas fa-angle-right"></i></h1>
        </summary>
        <h2 id="header-results-fitness">Fitness score</h2>
        <div id="container-results-fitness" style="width:100%">
            <div style="display:inline-block;width:100%;height:470px">
                <div id="fitness-surfaceplot" style="position: absolute; right: 0px"></div>
                <div style="float: left; width:45%">
                    <table id="fitness-table" style="width:100%;display:table;height:420px"></table>
                    <div id="fitness-pagination-container" style="font-size: medium;margin: 0 auto;text-align:center"></div>
                </div>
            </div>
            <div id="fitness-query" style="font-size:medium;display:block;width:100%"></div>
            <div id="fitness-score" style="font-size:medium;display:block;width:100%">
                <!-- <p id="fitness-score-exp">Experimental Scores: </p> -->
                <!-- <p id="fitness-score-predicted">Predicted Scores: </p> -->
                <a class="btn btn--primary" id="fitness-search" style="width:47%"><div style="margin:auto">Go</div></a>
                <a class="btn btn--primary" id="fitness-search-reset" style="width:47%"><div style="margin:auto">Reset</div></a>
            </div>
        </div>
        <div id="fitness-structure" style="position:relative; height: 400px; width:94%"></div>
        <h2 id="header-results-epistatic">Epistatic effects</h2>
    </details>
</div>
<div id="applications">
    <details open>
        <summary>
            <h1 id="header-applications">Applications  <i class="fas fa-angle-right"></i></h1>
        </summary>
        <h2 id="header-applications-lactamase">Beta-lactamase</h2>
        <div id="container-applications-lactamase" style="width: 100%">
            <img src="assets/figures/rl_density.gif" alt="rl_density" width="40%" style="margin: left 0;"/>
            <img src="assets/figures/rl_topk.gif" alt="rl_topk" width="55%" style="margin: right 0;"/>
        </div>
        <h2 id="header-applications-antibody">SARS-CoV2 antibody</h2>
</details>
</div>
<div id="method">
    <details open>
        <summary>
            <h1 id="header-method">Method & Concept  <i class="fas fa-angle-right"></i></h1>
        </summary>
        <h2 id="header-method-pretraining">Protein LLM</h2>
        <h2 id="header-method-rl">Reinforcement Learning</h2>
    </details>
</div>

<script>
    $(document).ready(function() {
        var viewerInstance = new PDBeMolstarPlugin();
        var options = {
        moleculeId: '1lp3',
        bgColor: {r:255, g:255, b:255},
        hideControls: true,
        }
        var viewerContainer = document.getElementById('fitness-structure');
        viewerInstance.render(viewerContainer, options);
        
        LoadTable('assets/tables/predictions/aav_less5.tsv').then(function(rows) {
            LoadTable('assets/tables/mutations/aav_less5_mutations.tsv').then(function(mutations) {
                TablePipeline(rows, viewerInstance);
                $("th[name='mutant']").click()
                AddQueryMutation(rows, 'mutant', 'fitness-query', 5, 1);
                LoadProcessedMutationOptions(mutations);
                $("#fitness-query").on('click', "i[class='fas fa-plus']", function() {
                    var curridx = parseInt($(this).attr('curridx'));
                    AddQueryMutation(rows, 'mutant', 'fitness-query', 5, curridx+1, true);
                    $(this).remove();
                    var [rest_rows, current_mutations]= ProcessQueries('#fitness-query input', rows);
                    UpdateMutationOptions(rest_rows, current_mutations, "#fitness-mutation-select-"+(curridx+1));
                    //LoadProcessedMutationOptions(mutations, "#fitness-mutation-select-"+(curridx+1));
                });
                $("#fitness-query").on('click', "i[class='fas fa-minus']", function() {
                    $(this).parent().remove();
                });
                $("#fitness-search").click(function() {
                    var [target_rows, query_mutations] = ProcessQueries('#fitness-query input', rows);
                    TablePipeline(target_rows, viewerInstance);
                });
                $("#fitness-search-reset").click(function() {
                    TablePipeline(rows, viewerInstance);
                    $("#fitness-query").empty();
                    AddQueryMutation(rows, 'mutant', 'fitness-query', 5, 1);
                    LoadProcessedMutationOptions(mutations);
                });
            });
            LoadTable('assets/tables/plotdata/aav_less5_pred.tsv').then(function(predictions) {
                LoadTable('assets/tables/plotdata/aav_less5_score.tsv').then(function(scores) {
                    var [x_names, y_names, prediction_z_data] = PreparePlotData(predictions);
                    var [x_names, y_names, scores_z_data] = PreparePlotData(scores);
                    PlotSurface(x_names, y_names, [prediction_z_data], 'fitness-surfaceplot');
                });
            });
        });
        
    });
    
</script>